#include <Arduino.h>
#include <SPI.h>
#include <GxEPD2.h>
#include <GxEPD2_BW.h>
#include <Fonts/FreeMonoBold9pt7b.h>
#include <Fonts/FreeMono9pt7b.h>
#define b1 10 // BOTON DE ENCENDIDO
#define b2 11 // BOTON DE MENU
#define ARRIBA 12
#define ABAJO 13
#define EPD_CS 5
#define EPD_DC 8
#define SRAM_CS -1
#define EPD_RESET 9
#define EPD_BUSY 7
#define EPD_SCLK 18
#define EPD_MISO 0
#define EPD_MOSI 19

int a = 0;

GxEPD2_BW<GxEPD2_290_GDEY029T94, GxEPD2_290_GDEY029T94::HEIGHT> display(
    GxEPD2_290_GDEY029T94(EPD_CS, EPD_DC, EPD_RESET, EPD_BUSY));

void setup()
{
    // Inicializa la comunicación serial
    Serial.begin(115200);
    Serial.println("Iniciando display ePaper...");
    SPI.begin();

    // Configura pines adicionales
    pinMode(EPD_DC, OUTPUT);
    pinMode(EPD_RESET, OUTPUT);
    pinMode(EPD_BUSY, INPUT);
    pinMode(b2, INPUT);
    pinMode(b1, INPUT);
    pinMode(ARRIBA, INPUT);
    pinMode(ABAJO, INPUT);

    // Inicializa la pantalla
    display.init();
    display.fillScreen(GxEPD_WHITE);
    display.setRotation(3); // Ajusta la rotación si es necesario
    delay(2000);
    a = 1;
    display.setTextColor(GxEPD_BLACK);
    display.setFont(&FreeMonoBold9pt7b);
    display.setFullWindow();
    display.firstPage();
    do
    { 
    display.fillScreen(GxEPD_WHITE);
    display.setTextSize(1);
    display.setFont(&FreeMono9pt7b);
    display.setCursor(10, 10);
    display.print("Fecha");
    display.setCursor(200, 10);
    display.print("Bateria");
    display.setFont(&FreeMonoBold9pt7b);
    display.setCursor(110, 64);
    display.print("Inicio");
    } while (display.nextPage());
}

void loop()
{
    switch (a)
    {
    case 1:
        display.fillScreen(GxEPD_WHITE);
        Serial.println("Precalentar");
        display.setFont(&FreeMono9pt7b);
        display.setCursor(10, 10);
        display.print("Fecha");
        display.setCursor(200, 10);
        display.print("Bateria");
        display.setCursor(90, 64);
        display.print("Precalentar");
        delay(2000);
        a = 2;
        break;
    }
}
